Traceback (most recent call last):
  File "/u/aa107/uiuc-cancer-research/src/model/validation/validate_tabnet.py", line 449, in main
    validation_report = validator.generate_comprehensive_report(model, X, y)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/aa107/uiuc-cancer-research/src/model/validation/validate_tabnet.py", line 319, in generate_comprehensive_report
    clinical_analysis = self.analyze_clinical_interpretability(model, X, y)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/aa107/uiuc-cancer-research/src/model/validation/validate_tabnet.py", line 168, in analyze_clinical_interpretability
    pathway_attention, explain_matrix, masks = model.analyze_clinical_attention(X_samples)
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/aa107/uiuc-cancer-research/src/model/tabnet_prostate_variant_classifier.py", line 298, in analyze_clinical_attention
    explain_matrix, masks = self.get_attention_masks(X[sample_indices])
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/aa107/uiuc-cancer-research/src/model/tabnet_prostate_variant_classifier.py", line 285, in get_attention_masks
    raise ValueError("Model not trained. Call train() first.")
ValueError: Model not trained. Call train() first.
🧬 TabNet Prostate Cancer Validation Framework
============================================================
📁 Loading model and data...
Loading dataset from: /u/aa107/uiuc-cancer-research/data/processed/tabnet_csv/prostate_variants_tabnet_imputed.csv
✅ Loaded 193,278 variants with 90 features
✅ Selected 13 features from 14 candidates
   Core features: ['sift_score', 'polyphen_score']
   Confidence features: ['sift_confidence', 'polyphen_confidence', 'functional_pathogenicity']
✅ Preprocessed to 13 features, 3 classes
✅ Loaded 193,278 variants with 13 features
📊 Generating comprehensive validation report...
🔄 Running 5-fold cross-validation...
  📊 Processing fold 1/5...
🚀 Starting TabNet training...
✅ Using device: cuda
epoch 0  | loss: 0.09367 | val_0_accuracy: 0.99997 |  0:00:09s
epoch 1  | loss: 0.00301 | val_0_accuracy: 1.0     |  0:00:17s
epoch 2  | loss: 0.00088 | val_0_accuracy: 1.0     |  0:00:25s
epoch 3  | loss: 0.00073 | val_0_accuracy: 1.0     |  0:00:33s
epoch 4  | loss: 0.00048 | val_0_accuracy: 1.0     |  0:00:41s
epoch 5  | loss: 0.00043 | val_0_accuracy: 1.0     |  0:00:49s
epoch 6  | loss: 0.00037 | val_0_accuracy: 1.0     |  0:00:57s
epoch 7  | loss: 0.00031 | val_0_accuracy: 1.0     |  0:01:05s
epoch 8  | loss: 0.00026 | val_0_accuracy: 1.0     |  0:01:13s
epoch 9  | loss: 0.00023 | val_0_accuracy: 1.0     |  0:01:21s
epoch 10 | loss: 0.0002  | val_0_accuracy: 0.99995 |  0:01:29s
epoch 11 | loss: 0.00018 | val_0_accuracy: 0.99995 |  0:01:37s
epoch 12 | loss: 0.00016 | val_0_accuracy: 0.99995 |  0:01:45s
epoch 13 | loss: 0.00014 | val_0_accuracy: 0.99997 |  0:01:53s
epoch 14 | loss: 0.00013 | val_0_accuracy: 1.0     |  0:02:01s
epoch 15 | loss: 0.00012 | val_0_accuracy: 1.0     |  0:02:09s
epoch 16 | loss: 0.01309 | val_0_accuracy: 1.0     |  0:02:17s

Early stopping occurred at epoch 16 with best_epoch = 1 and best_val_0_accuracy = 1.0
✅ Training completed!
✅ Validation Accuracy: 1.000
    ✅ Fold 1 accuracy: 1.000
  📊 Processing fold 2/5...
🚀 Starting TabNet training...
✅ Using device: cuda
epoch 0  | loss: 0.0668  | val_0_accuracy: 0.99886 |  0:00:08s
epoch 1  | loss: 0.00528 | val_0_accuracy: 1.0     |  0:00:16s
epoch 2  | loss: 0.00059 | val_0_accuracy: 1.0     |  0:00:24s
epoch 3  | loss: 0.00052 | val_0_accuracy: 1.0     |  0:00:32s
epoch 4  | loss: 0.00068 | val_0_accuracy: 1.0     |  0:00:40s
epoch 5  | loss: 0.00042 | val_0_accuracy: 1.0     |  0:00:48s
epoch 6  | loss: 0.00036 | val_0_accuracy: 1.0     |  0:00:56s
epoch 7  | loss: 0.00031 | val_0_accuracy: 1.0     |  0:01:04s
epoch 8  | loss: 0.00028 | val_0_accuracy: 1.0     |  0:01:12s
epoch 9  | loss: 0.00026 | val_0_accuracy: 1.0     |  0:01:20s
epoch 10 | loss: 0.00024 | val_0_accuracy: 1.0     |  0:01:28s
epoch 11 | loss: 0.00022 | val_0_accuracy: 1.0     |  0:01:37s
epoch 12 | loss: 0.0002  | val_0_accuracy: 1.0     |  0:01:45s
epoch 13 | loss: 0.00029 | val_0_accuracy: 1.0     |  0:01:53s
epoch 14 | loss: 0.00019 | val_0_accuracy: 1.0     |  0:02:01s
epoch 15 | loss: 0.00017 | val_0_accuracy: 1.0     |  0:02:09s
epoch 16 | loss: 0.00015 | val_0_accuracy: 1.0     |  0:02:17s

Early stopping occurred at epoch 16 with best_epoch = 1 and best_val_0_accuracy = 1.0
✅ Training completed!
✅ Validation Accuracy: 1.000
    ✅ Fold 2 accuracy: 1.000
  📊 Processing fold 3/5...
🚀 Starting TabNet training...
✅ Using device: cuda
epoch 0  | loss: 0.08365 | val_0_accuracy: 0.99995 |  0:00:08s
epoch 1  | loss: 0.00103 | val_0_accuracy: 1.0     |  0:00:16s
epoch 2  | loss: 0.00058 | val_0_accuracy: 1.0     |  0:00:24s
epoch 3  | loss: 0.00051 | val_0_accuracy: 1.0     |  0:00:32s
epoch 4  | loss: 0.00046 | val_0_accuracy: 1.0     |  0:00:40s
epoch 5  | loss: 0.00042 | val_0_accuracy: 1.0     |  0:00:48s
epoch 6  | loss: 0.00038 | val_0_accuracy: 1.0     |  0:00:56s
epoch 7  | loss: 0.00035 | val_0_accuracy: 1.0     |  0:01:04s
epoch 8  | loss: 0.00032 | val_0_accuracy: 1.0     |  0:01:12s
epoch 9  | loss: 0.00029 | val_0_accuracy: 1.0     |  0:01:20s
epoch 10 | loss: 0.00939 | val_0_accuracy: 0.99977 |  0:01:28s
epoch 11 | loss: 0.00043 | val_0_accuracy: 0.99995 |  0:01:37s
epoch 12 | loss: 0.00031 | val_0_accuracy: 0.99997 |  0:01:45s
epoch 13 | loss: 0.00028 | val_0_accuracy: 1.0     |  0:01:53s
epoch 14 | loss: 0.00027 | val_0_accuracy: 1.0     |  0:02:01s
epoch 15 | loss: 0.00019 | val_0_accuracy: 1.0     |  0:02:09s
epoch 16 | loss: 0.00016 | val_0_accuracy: 1.0     |  0:02:17s

Early stopping occurred at epoch 16 with best_epoch = 1 and best_val_0_accuracy = 1.0
✅ Training completed!
✅ Validation Accuracy: 1.000
    ✅ Fold 3 accuracy: 1.000
  📊 Processing fold 4/5...
🚀 Starting TabNet training...
✅ Using device: cuda
epoch 0  | loss: 0.07543 | val_0_accuracy: 0.99992 |  0:00:08s
epoch 1  | loss: 0.00103 | val_0_accuracy: 0.99997 |  0:00:16s
epoch 2  | loss: 0.00142 | val_0_accuracy: 0.97154 |  0:00:24s
epoch 3  | loss: 0.0095  | val_0_accuracy: 1.0     |  0:00:32s
epoch 4  | loss: 0.00042 | val_0_accuracy: 1.0     |  0:00:40s
epoch 5  | loss: 0.00035 | val_0_accuracy: 1.0     |  0:00:48s
epoch 6  | loss: 0.0003  | val_0_accuracy: 1.0     |  0:00:56s
epoch 7  | loss: 0.00027 | val_0_accuracy: 1.0     |  0:01:04s
epoch 8  | loss: 0.00025 | val_0_accuracy: 1.0     |  0:01:13s
epoch 9  | loss: 0.00337 | val_0_accuracy: 1.0     |  0:01:21s
epoch 10 | loss: 0.00033 | val_0_accuracy: 1.0     |  0:01:29s
epoch 11 | loss: 0.00029 | val_0_accuracy: 1.0     |  0:01:37s
epoch 12 | loss: 0.00026 | val_0_accuracy: 1.0     |  0:01:45s
epoch 13 | loss: 0.00024 | val_0_accuracy: 1.0     |  0:01:53s
epoch 14 | loss: 0.00022 | val_0_accuracy: 1.0     |  0:02:01s
epoch 15 | loss: 0.0002  | val_0_accuracy: 1.0     |  0:02:10s
epoch 16 | loss: 0.00018 | val_0_accuracy: 1.0     |  0:02:18s
epoch 17 | loss: 0.00017 | val_0_accuracy: 1.0     |  0:02:26s
epoch 18 | loss: 0.00016 | val_0_accuracy: 1.0     |  0:02:34s

Early stopping occurred at epoch 18 with best_epoch = 3 and best_val_0_accuracy = 1.0
✅ Training completed!
✅ Validation Accuracy: 1.000
    ✅ Fold 4 accuracy: 1.000
  📊 Processing fold 5/5...
🚀 Starting TabNet training...
✅ Using device: cuda
epoch 0  | loss: 0.07021 | val_0_accuracy: 0.9999  |  0:00:08s
epoch 1  | loss: 0.00169 | val_0_accuracy: 0.99987 |  0:00:16s
epoch 2  | loss: 0.00185 | val_0_accuracy: 0.9999  |  0:00:24s
epoch 3  | loss: 0.00224 | val_0_accuracy: 0.99972 |  0:00:32s
epoch 4  | loss: 0.01517 | val_0_accuracy: 0.9999  |  0:00:40s
epoch 5  | loss: 0.00075 | val_0_accuracy: 0.99992 |  0:00:48s
epoch 6  | loss: 0.0005  | val_0_accuracy: 0.99997 |  0:00:57s
epoch 7  | loss: 0.00236 | val_0_accuracy: 0.99992 |  0:01:05s
epoch 8  | loss: 0.00073 | val_0_accuracy: 0.99995 |  0:01:13s
epoch 9  | loss: 0.00031 | val_0_accuracy: 0.99992 |  0:01:21s
epoch 10 | loss: 0.00027 | val_0_accuracy: 0.99995 |  0:01:29s
epoch 11 | loss: 0.00024 | val_0_accuracy: 0.99997 |  0:01:37s
epoch 12 | loss: 0.00023 | val_0_accuracy: 0.99997 |  0:01:45s
epoch 13 | loss: 0.00024 | val_0_accuracy: 0.99997 |  0:01:54s
epoch 14 | loss: 0.0002  | val_0_accuracy: 0.99842 |  0:02:02s
epoch 15 | loss: 0.00019 | val_0_accuracy: 0.99997 |  0:02:10s
epoch 16 | loss: 0.00022 | val_0_accuracy: 0.9999  |  0:02:18s
epoch 17 | loss: 0.00018 | val_0_accuracy: 0.99987 |  0:02:26s
epoch 18 | loss: 0.00017 | val_0_accuracy: 0.99995 |  0:02:34s
epoch 19 | loss: 0.00016 | val_0_accuracy: 0.99995 |  0:02:42s
epoch 20 | loss: 0.00015 | val_0_accuracy: 0.99995 |  0:02:50s
epoch 21 | loss: 0.00014 | val_0_accuracy: 0.99995 |  0:02:59s

Early stopping occurred at epoch 21 with best_epoch = 6 and best_val_0_accuracy = 0.99997
✅ Training completed!
✅ Validation Accuracy: 1.000
    ✅ Fold 5 accuracy: 1.000
✅ Cross-validation completed!
   Mean accuracy: 1.000 ± 0.000
   95% CI: [1.000, 1.000]
🎯 Evaluating performance targets...
✅ Target achieved: 1.000 >= 0.820
🔍 Analyzing clinical interpretability...
❌ Validation failed: Model not trained. Call train() first.
