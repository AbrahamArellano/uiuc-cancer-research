=== PHASE 3 VEP OPTIMIZATION (FIXED) STARTED: Wed Jun 25 00:14:03 CDT 2025 ===
üéØ Target: Improve success rate from 91.1% to 95%+
üîß Fix: Removed problematic preprocessing, using original VCF
üì¶ Downloading BioContainers VEP (114.1)...
‚úÖ BioContainers VEP downloaded
üìä Validating input file...
‚úÖ Input variants: 195147
üîß PHASE 3 OPTIMIZATION: Using original VCF directly
  ‚ö†Ô∏è Skipping coordinate sorting (was corrupting VCF format)
  ‚ö†Ô∏è Skipping chromosome standardization (was causing parse errors)
  ‚úÖ Relying on VEP's built-in error handling
üìö Setting up VEP cache...
Installing VEP cache for human GRCh38...
WARNING: Unable to carry out version check for 'ensembl-vep'
 - getting list of available cache files
 - downloading https://ftp.ensembl.org/pub/release-114/variation/indexed_vep_cache/homo_sapiens_vep_114_GRCh38.tar.gz
 - unpacking homo_sapiens_vep_114_GRCh38.tar.gz
 - converting cache, this may take some time but will allow VEP to look up variants and frequency data much faster
 - use CTRL-C to cancel if you do not wish to convert this cache now (you may run convert_cache.pl later)
2025-06-25 00:54:52 - Processing homo_sapiens
2025-06-25 00:54:52 - Processing version 114_GRCh38
2025-06-25 00:54:53 - No unprocessed types remaining, skipping
2025-06-25 00:54:53 - All done!
 - downloading Homo_sapiens.GRCh38.dna.toplevel.fa.gz
 - downloading Homo_sapiens.GRCh38.dna.toplevel.fa.gz.fai
 - downloading Homo_sapiens.GRCh38.dna.toplevel.fa.gz.gzi

The FASTA file should be automatically detected by the VEP when using --cache or --offline.
If it is not, use "--fasta /u/aa107/uiuc-cancer-research/data/processed/vep/vep_cache/homo_sapiens/114_GRCh38/Homo_sapiens.GRCh38.dna.toplevel.fa.gz"


All done
‚úÖ VEP cache installation completed
‚ö° PHASE 3 OPTIMIZATION: VEP Parameter Tuning
üìä Large dataset: buffer=7500, forks=12
üß™ Testing VEP with small sample...
‚úÖ Test successful: 992 variants processed
üöÄ Running optimized VEP annotation (without problematic preprocessing)...
WARNING: 987798 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
WARNING: 1013805 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 5993.
WARNING: 1020644 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 6950.
WARNING: 1026995 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 7343.
WARNING: 1093564 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 14172.
WARNING: 1185395 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 23016.
VEP exit code: 0
üîç PHASE 3 ENHANCED VALIDATION
=== PHASE 3 ENHANCED VALIDATION REPORT ===
Generated: Wed Jun 25 06:09:21 CDT 2025
Phase: 3 - VEP Optimization (Fixed Version)
Fix Applied: Removed problematic preprocessing

‚úÖ VEP annotation completed
Input variants: 195147
Output variants: 195147
Success rate: 100.0%
üéØ PHASE 3 SUCCESS: Target achieved (‚â•95%)

üß¨ ANNOTATION COMPLETENESS:
CSQ annotation rate: 100.0%
SIFT annotation rate: 0
0%
PolyPhen annotation rate: 0
0%

üî¨ FUNCTIONAL CONSEQUENCES:
  Missense variants: 76739
  Stop gained: 8798
  Splice variants: 32454

üìÅ OUTPUT METRICS:
Output file size: 1.9G
VEP parameter optimization applied: ‚úÖ
Problematic preprocessing removed: ‚úÖ
‚ö†Ô∏è VEP warnings: 59
Sample warnings (first 5):
WARNING: 987798 : substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.
substr outside of string at /usr/local/share/ensembl-vep-114.1-0/Bio/EnsEMBL/Variation/Utils/VariationEffect.pm line 1061, <__ANONIO__> line 3724.

=== PHASE 3 COMPLETION SUMMARY ===
üéØ Target: 95%+ success rate
üìä Baseline: 91.1% (previous run)
üìä Achieved: 100.0%
üèÜ Status: ‚úÖ PASSED

üîß OPTIMIZATIONS APPLIED:
  ‚úÖ Conservative VEP parameter optimization
  ‚úÖ Dynamic buffer sizing (7500)
  ‚úÖ Optimized fork count (12)
  ‚úÖ Added VEP tolerance flags (--no_check_variants_order, --allow_non_variant)
  ‚úÖ Enhanced validation reporting

üîß FIXES APPLIED:
  ‚ùå Removed bcftools sorting (was corrupting VCF)
  ‚ùå Removed chromosome standardization (was causing parse errors)
  ‚úÖ Using original VCF directly
  ‚úÖ Relying on VEP's built-in error handling

=== FILES GENERATED ===
total 2.5G
-rw------- 1 aa107 root  49K Jun 25 00:57 test_output.vcf_summary.html
-rw------- 1 aa107 root 2.1K Jun 25 06:09 validation_report.txt
-rwx------ 1 aa107 root 640M Jun 25 00:14 vep-biocontainer.sif
-rw------- 1 aa107 root 1.9G Jun 25 06:09 vep_annotated.vcf
-rw------- 1 aa107 root  11K Jun 25 06:09 vep_annotation.log
drwx--S--- 2 aa107 root 4.0K Jun 25 00:56 vep_cache
-rw------- 1 aa107 root  56K Jun 25 06:09 vep_summary.html
-rw------- 1 aa107 root 8.6K Jun 25 01:33 vep_warnings.txt

=== NEXT STEPS ===
1. Review validation report: /u/aa107/uiuc-cancer-research/data/processed/vep/validation_report.txt
2. Check VEP summary: /u/aa107/uiuc-cancer-research/data/processed/vep/vep_summary.html
3. Analyze VEP warnings: /u/aa107/uiuc-cancer-research/data/processed/vep/vep_warnings.txt
4. Convert VCF to CSV for TabNet: python scripts/vep/vcf_to_tabnet.py
5. Proceed with TabNet training
=== PHASE 3 VEP OPTIMIZATION (FIXED) COMPLETED: Wed Jun 25 06:09:26 CDT 2025 ===
‚úÖ PHASE 3 COMPLETE! VEP annotation: 195147 variants
üìä Success rate: 100.0% (Baseline: 91.1%)
üéØ Phase 3 status: ‚úÖ PASSED
üìÅ Main output: /u/aa107/uiuc-cancer-research/data/processed/vep/vep_annotated.vcf
üìã Report: /u/aa107/uiuc-cancer-research/data/processed/vep/validation_report.txt
üéâ SUCCESS: Maintained or improved success rate!
